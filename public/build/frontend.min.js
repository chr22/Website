/*! SvejstrupsPlayground 2013-12-29 */
"use strict";var myApp=angular.module("myApp",["ngRoute"]);myApp.config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"partials/index"}).when("/posts",{templateUrl:"partials/posts"}).when("/addPost",{templateUrl:"partials/addPost"}).when("/readPost/:id",{templateUrl:"partials/readPost"}).when("/editPost/:id",{templateUrl:"partials/editPost"}).when("/deletePost/:id",{templateUrl:"partials/deletePost"}).when("/schedules",{templateUrl:"partials/schedules"}).when("/comments",{templateUrl:"partials/comments"}).when("/about",{templateUrl:"partials/about"}).otherwise({redirectTo:"/"})}]),myApp.factory("PostService",["$http",function(a){var b=[],c={};return{ReplacePosts:function(a){return b=a},GetPost:function(a){return b.forEach(function(b){return b._id==a?(c=b,b):void 0}),c},GetPostsFromServer:function(){return a.get("/posts/posts").success(function(a){b=a.posts})},GetPostsFromClient:function(){return b},GetPostCount:function(){return b.length},DeletePost:function(c){return a.delete("/posts/post/"+c).success(function(){for(var a=0;a<b.length;a++)b[a]._id==c&&b.splice(a,1)})},AddPost:function(c){return a.post("/posts/post",c).success(function(a){b.push(a[0])})},EditPost:function(c){return a.put("/posts/post/"+c._id,c).success(function(){for(var a=0;a<b.length;a++)b[a]._id==c._id&&(b[a]=c)})}}}]),myApp.controller("BaseCtrl",["$scope","$http",function(){}]),myApp.controller("IndexCtrl",["$scope","$http",function(){}]),myApp.controller("CommentsCtrl",["$scope","$location","$routeParams","PostService",function(){}]),myApp.controller("AddPostCtrl",["$scope","$http","$location","PostService",function(a,b,c,d){a.form={},a.AddPost=function(){d.AddPost(a.form).success(function(a){console.log(a),c.path("/posts")})}}]),myApp.controller("DeletePostCtrl",["$scope","$http","$location","$routeParams","PostService",function(a,b,c,d,e){a.post={},a.ReadPost=function(){a.post=e.GetPost(d.id)}(),a.DeletePost=function(){e.DeletePost(d.id).success(function(){c.path("/posts")})},a.Home=function(){c.path("/posts")}}]),myApp.controller("EditPostCtrl",["$scope","$http","$location","$routeParams","PostService",function(a,b,c,d,e){a.form=e.GetPost(d.id),a.copy={},a.copyForm=function(){angular.copy(a.form,a.copy)}(),a.EditPost=function(){e.EditPost(a.copy).success(function(){c.path("/posts")})},a.Cancel=function(){c.path("/posts")}}]),myApp.controller("PostsCtrl",["$scope","$location","$routeParams","PostService",function(a,b,c,d){a.form={},a.posts={},a.post={},a.GetPosts=function(){d.GetPostCount()<=0?d.GetPostsFromServer().success(function(b){a.posts=b.posts}):a.posts=d.GetPostsFromClient()}(),a.ReadPost=function(a){b.path("/readPost/"+a)},a.EditPost=function(a){b.path("/editPost/"+a)},a.DeletePost=function(a){b.path("/deletePost/"+a)}}]),myApp.controller("ReadPostCtrl",["$scope","$routeParams","PostService",function(a,b,c){a.post={},a.ReadPost=function(){a.post=c.GetPost(b.id)}()}]),myApp.controller("SchedulesCtrl",["$scope","$location","$routeParams","PostService",function(){}]);