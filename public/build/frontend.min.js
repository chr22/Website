/*! SvejstrupsPlayground 2014-01-10 */
"use strict";var myApp=angular.module("myApp",["ngRoute"]);!function(){myApp.config(["$routeProvider","$locationProvider",function(a){a.when("/",{templateUrl:"partials/index"}).when("/login",{templateUrl:"partials/login"}).when("/user",{templateUrl:"partials/user"}).when("/posts",{templateUrl:"partials/posts/posts"}).when("/addPost",{templateUrl:"partials/posts/addPost"}).when("/readPost/:id",{templateUrl:"partials/posts/readPost"}).when("/editPost/:id",{templateUrl:"partials/posts/editPost"}).when("/deletePost/:id",{templateUrl:"partials/posts/deletePost"}).when("/schedules",{templateUrl:"partials/schedules/schedules"}).when("/comments",{templateUrl:"partials/comments/comments"}).when("/reports",{templateUrl:"partials/reports/reports"}).when("/readReport/:id",{templateUrl:"partials/reports/readReport"}).when("/addReport",{templateUrl:"partials/reports/addReport"}).when("/about",{templateUrl:"partials/about"}).otherwise({redirectTo:"/"})}])}(),function(){myApp.factory("PostService",["$http",function(a){var b=[],c={};return{ReplacePosts:function(a){return b=a},GetPost:function(a){return b.forEach(function(b){return b._id==a?(c=b,b):void 0}),c},GetPostsFromServer:function(){return a.get("/posts/posts").success(function(a){b=a.posts})},GetPostsFromClient:function(){return b},GetPostCount:function(){return b.length},DeletePost:function(c){return a.delete("/posts/post/"+c).success(function(){for(var a=0;a<b.length;a++)b[a]._id==c&&b.splice(a,1)})},AddPost:function(c){return a.post("/posts/post",c).success(function(a){b.push(a[0])})},EditPost:function(c){return a.put("/posts/post/"+c._id,c).success(function(){for(var a=0;a<b.length;a++)b[a]._id==c._id&&(b[a]=c)})}}}]),myApp.factory("ReportService",["$http",function(a){var b=[],c={};return{GetReportsFromServer:function(){return a.get("/reports/reports").success(function(a){b=a.reports})},GetReportsFromClient:function(){return b},GetReportCount:function(){return b.length},AddReport:function(c){return a.post("/reports/addReport/",c).success(function(a){console.log(a),b.push(a[0])})},GetReport:function(a){return b.forEach(function(b){return b._id==a?(c=b,b):void 0}),c}}}])}(),function(){myApp.controller("BaseCtrl",["$scope","$window",function(a,b){a.back=function(){console.log("back"),b.history.back()}}])}(),function(){myApp.controller("IndexCtrl",["$scope","$http",function(){}])}(),function(){myApp.controller("LoginCtrl",["$scope","$http","$location",function(a,b,c){a.username="",a.password="",a.formData={},a.submit=function(){b({method:"POST",url:"/login",data:a.formData}).success(function(a){console.log(a),c.path("/user")}).error(function(a){console.log(a),alert("Wrong username / password combo!")})}}])}(),function(){myApp.controller("CommentsCtrl",["$scope","$location","$routeParams",function(){}])}(),function(){myApp.controller("AddPostCtrl",["$scope","$http","$location","PostService",function(a,b,c,d){a.form={},a.AddPost=function(){d.AddPost(a.form).success(function(a){console.log(a),c.path("/posts")})}}])}(),function(){myApp.controller("DeletePostCtrl",["$scope","$http","$location","$routeParams","PostService",function(a,b,c,d,e){a.post={},a.ReadPost=function(){a.post=e.GetPost(d.id)}(),a.DeletePost=function(){e.DeletePost(d.id).success(function(){c.path("/posts")})},a.Home=function(){c.path("/posts")}}])}(),function(){myApp.controller("EditPostCtrl",["$scope","$http","$location","$routeParams","PostService",function(a,b,c,d,e){a.form=e.GetPost(d.id),a.copy={},a.copyForm=function(){angular.copy(a.form,a.copy)}(),a.EditPost=function(){e.EditPost(a.copy).success(function(){c.path("/posts")})},a.Cancel=function(){c.path("/posts")}}])}(),function(){myApp.controller("PostsCtrl",["$scope","$location","$routeParams","PostService",function(a,b,c,d){a.form={},a.posts=[],a.post={},a.GetPosts=function(){d.GetPostCount()<=0?d.GetPostsFromServer().success(function(b){a.posts=b.posts}):a.posts=d.GetPostsFromClient()}(),a.ReadPost=function(a){b.path("/readPost/"+a)},a.EditPost=function(a){b.path("/editPost/"+a)},a.DeletePost=function(a){b.path("/deletePost/"+a)}}])}(),function(){myApp.controller("ReadPostCtrl",["$scope","$routeParams","PostService","$location",function(a,b,c,d){a.post={},a.ReadPost=function(){a.post=c.GetPost(b.id)}(),a.EditPost=function(a){d.path("/editPost/"+a)},a.DeletePost=function(a){d.path("/deletePost/"+a)}}])}(),myApp.controller("SchedulesCtrl",["$scope","$location","$routeParams","PostService",function(){}]);